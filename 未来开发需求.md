我需要使用以下接口，实现交互式预约而不只是直接读取用户的预选座位。


# 《我去图书馆》API 接口集合（非官方 · GraphQL）

> ⚠️ 说明
>
> * 非官方文档
> * 基于抓包 & 反向整理
> * 实际字段/operationName 可能随版本变化
> * 所有接口共用 **GraphQL 单一入口**

---

## 一、统一接口说明

### Base URL

```text
POST https://xxxx/graphql
```

### 通用 Header

```http
Content-Type: application/json
Cookie: <微信会话 Cookie>
```

### 通用 Body 结构

```json
{
  "operationName": "",
  "query": "",
  "variables": {}
}
```

---

## 二、用户 / 会话接口

### 1. 用户登录

```json
{
  "operationName": "login",
  "query": "mutation login($code:String!){login(code:$code){token userId}}",
  "variables": {
    "code": "wx.login 返回的 code"
  }
}
```

---

### 2. 心跳保持

```json
{
  "operationName": "heartbeat",
  "query": "query heartbeat{heartbeat}",
  "variables": {}
}
```

---

## 三、图书馆基础数据

### 3. 获取图书馆列表

```json
{
  "operationName": "queryLibList",
  "query": "query queryLibList{libList{id name status}}",
  "variables": {}
}
```

---

### 4. 获取楼层列表

```json
{
  "operationName": "queryFloorList",
  "query": "query queryFloorList($libId:Int!){floorList(libId:$libId){id name}}",
  "variables": {
    "libId": 525
  }
}
```

---

### 5. 获取座位列表

```json
{
  "operationName": "querySeatList",
  "query": "query querySeatList($floorId:Int!){seatList(floorId:$floorId){seatKey status}}",
  "variables": {
    "floorId": 12
  }
}
```

---

### 6. 查询座位状态

```json
{
  "operationName": "querySeatStatus",
  "query": "query querySeatStatus($libId:Int!){seatStatus(libId:$libId){seatKey status}}",
  "variables": {
    "libId": 525
  }
}
```

---

## 四、预约核心接口

### 7. 预约座位（今日）

```json
{
  "operationName": "reserveSeat",
  "query": "mutation reserveSeat($libId:Int!,$seatKey:String!,$captcha:String){reserveSeat(libId:$libId,seatKey:$seatKey,captcha:$captcha){success msg}}",
  "variables": {
    "libId": 525,
    "seatKey": "35,18",
    "captcha": ""
  }
}
```

---

### 8. 取消预约

```json
{
  "operationName": "cancelReserve",
  "query": "mutation cancelReserve{cancelReserve{success msg}}",
  "variables": {}
}
```

---

### 9. 查询当前预约

```json
{
  "operationName": "getReserveInfo",
  "query": "query getReserveInfo{reserveInfo{libId seatKey date status}}",
  "variables": {}
}
```

---

## 五、明日预约 / 抢座

### 10. 查询明日可预约时段

```json
{
  "operationName": "queryTomorrowSlots",
  "query": "query queryTomorrowSlots($libId:Int!){tomorrowSlots(libId:$libId){time available}}",
  "variables": {
    "libId": 525
  }
}
```

---

### 11. 加入排队

```json
{
  "operationName": "joinQueue",
  "query": "mutation joinQueue($libId:Int!){joinQueue(libId:$libId){queueId position}}",
  "variables": {
    "libId": 525
  }
}
```

---

### 12. 查询排队状态

```json
{
  "operationName": "queryQueueStatus",
  "query": "query queryQueueStatus($queueId:String!){queueStatus(queueId:$queueId){position status}}",
  "variables": {
    "queueId": "xxxx"
  }
}
```

---

## 六、验证码相关

### 13. 获取验证码

```json
{
  "operationName": "getCaptcha",
  "query": "query getCaptcha{captcha{image token}}",
  "variables": {}
}
```

---

### 14. 校验验证码

```json
{
  "operationName": "checkCaptcha",
  "query": "mutation checkCaptcha($token:String!,$code:String!){checkCaptcha(token:$token,code:$code)}",
  "variables": {
    "token": "xxxx",
    "code": "1234"
  }
}
```

---

## 七、个人信息

### 15. 查询绑定信息

```json
{
  "operationName": "queryMyBindings",
  "query": "query queryMyBindings{bindings{libId userNo}}",
  "variables": {}
}
```

---

### 16. 历史预约记录

```json
{
  "operationName": "queryMyHistory",
  "query": "query queryMyHistory{history{date seatKey status}}",
  "variables": {}
}
```

---

## 八、接口总览（速查）

```text
login
heartbeat
queryLibList
queryFloorList
querySeatList
querySeatStatus
reserveSeat
cancelReserve
getReserveInfo
queryTomorrowSlots
joinQueue
queryQueueStatus
getCaptcha
checkCaptcha
queryMyBindings
queryMyHistory
```

---
